2025-11-19 09:30:11,379 | film_recommender_cg.trainer | INFO | 'Trainer' object instantiated; W&B run initialized.
Checking if retraining required...
[34m[1mwandb[0m:   1 of 1 files downloaded.
[34m[1mwandb[0m:   1 of 1 files downloaded.
[34m[1mwandb[0m:   1 of 1 files downloaded.
[34m[1mwandb[0m:   1 of 1 files downloaded.
Retraining required as at least one performance metric found to have degraded in the current model...
2025-11-19 09:30:19,337 | film_recommender_cg.trainer | INFO | Loading in 'ratings' data...
2025-11-19 09:30:23,368 | film_recommender_cg.db_connector | INFO | Successfully read collection 'ratings'. Shape of df: (139100, 4)
2025-11-19 09:30:23,402 | film_recommender_cg.trainer | INFO | Data successfully loaded!
2025-11-19 09:30:23,405 | film_recommender_cg.trainer | INFO | Importing 'Champion' SVD model from Weights & Biases...
[34m[1mwandb[0m:   1 of 1 files downloaded.
2025-11-19 09:30:26,577 | film_recommender_cg.trainer | INFO | Model successfully imported!
2025-11-19 09:30:26,580 | film_recommender_cg.trainer | INFO | Training SVD model...
2025-11-19 09:30:29,179 | film_recommender_cg.trainer | INFO | SVD model successfully trained!
2025-11-19 09:30:29,187 | film_recommender_cg.trainer | INFO | Evaluating SVD model...
2025-11-19 09:30:29,437 | film_recommender_cg.trainer | INFO | ### Model Performance Metrics (Overall): ###
2025-11-19 09:30:29,440 | film_recommender_cg.trainer | INFO | RMSE: 0.839
2025-11-19 09:30:29,443 | film_recommender_cg.trainer | INFO | squared: 0.3
2025-11-19 09:30:29,783 | film_recommender_cg.trainer | INFO | Loading in 'genres' table...
2025-11-19 09:30:29,980 | film_recommender_cg.db_connector | INFO | Successfully read collection 'genres'. Shape of df: (4877, 2)
2025-11-19 09:30:30,176 | film_recommender_cg.trainer | INFO | Table successfully loaded!
2025-11-19 09:30:30,190 | film_recommender_cg.trainer | INFO | ### Model Performance Metrics (by Genre): ###
2025-11-19 09:30:30,217 | film_recommender_cg.trainer | INFO | 'Action' rmse = 0.86
2025-11-19 09:30:30,220 | film_recommender_cg.trainer | INFO | 'Action' r-squared = 0.309
2025-11-19 09:30:30,239 | film_recommender_cg.trainer | INFO | 'Horror' rmse = 0.931
2025-11-19 09:30:30,243 | film_recommender_cg.trainer | INFO | 'Horror' r-squared = 0.291
2025-11-19 09:30:30,260 | film_recommender_cg.trainer | INFO | 'Documentary' rmse = 0.719
2025-11-19 09:30:30,264 | film_recommender_cg.trainer | INFO | 'Documentary' r-squared = 0.069
2025-11-19 09:30:30,288 | film_recommender_cg.trainer | INFO | 'Comedy' rmse = 0.866
2025-11-19 09:30:30,293 | film_recommender_cg.trainer | INFO | 'Comedy' r-squared = 0.287
2025-11-19 09:30:30,315 | film_recommender_cg.trainer | INFO | 'Crime' rmse = 0.807
2025-11-19 09:30:30,318 | film_recommender_cg.trainer | INFO | 'Crime' r-squared = 0.322
2025-11-19 09:30:30,337 | film_recommender_cg.trainer | INFO | 'Science Fiction' rmse = 0.888
2025-11-19 09:30:30,342 | film_recommender_cg.trainer | INFO | 'Science Fiction' r-squared = 0.319
2025-11-19 09:30:30,365 | film_recommender_cg.trainer | INFO | 'History' rmse = 0.763
2025-11-19 09:30:30,370 | film_recommender_cg.trainer | INFO | 'History' r-squared = 0.239
2025-11-19 09:30:30,397 | film_recommender_cg.trainer | INFO | 'Mystery' rmse = 0.836
2025-11-19 09:30:30,401 | film_recommender_cg.trainer | INFO | 'Mystery' r-squared = 0.283
2025-11-19 09:30:30,424 | film_recommender_cg.trainer | INFO | 'Drama' rmse = 0.805
2025-11-19 09:30:30,428 | film_recommender_cg.trainer | INFO | 'Drama' r-squared = 0.258
2025-11-19 09:30:30,446 | film_recommender_cg.trainer | INFO | 'Music' rmse = 0.921
2025-11-19 09:30:30,449 | film_recommender_cg.trainer | INFO | 'Music' r-squared = 0.207
2025-11-19 09:30:30,475 | film_recommender_cg.trainer | INFO | 'Western' rmse = 0.817
2025-11-19 09:30:30,478 | film_recommender_cg.trainer | INFO | 'Western' r-squared = 0.354
2025-11-19 09:30:30,497 | film_recommender_cg.trainer | INFO | 'Animation' rmse = 0.841
2025-11-19 09:30:30,501 | film_recommender_cg.trainer | INFO | 'Animation' r-squared = 0.243
2025-11-19 09:30:30,518 | film_recommender_cg.trainer | INFO | 'TV Movie' rmse = Insufficient Data
2025-11-19 09:30:30,521 | film_recommender_cg.trainer | INFO | 'TV Movie' r-squared = Insufficient Data
2025-11-19 09:30:30,545 | film_recommender_cg.trainer | INFO | 'Foreign' rmse = 0.682
2025-11-19 09:30:30,548 | film_recommender_cg.trainer | INFO | 'Foreign' r-squared = 0.231
2025-11-19 09:30:30,571 | film_recommender_cg.trainer | INFO | 'Romance' rmse = 0.842
2025-11-19 09:30:30,574 | film_recommender_cg.trainer | INFO | 'Romance' r-squared = 0.275
2025-11-19 09:30:30,590 | film_recommender_cg.trainer | INFO | 'Adventure' rmse = 0.875
2025-11-19 09:30:30,593 | film_recommender_cg.trainer | INFO | 'Adventure' r-squared = 0.31
2025-11-19 09:30:30,616 | film_recommender_cg.trainer | INFO | 'War' rmse = 0.758
2025-11-19 09:30:30,619 | film_recommender_cg.trainer | INFO | 'War' r-squared = 0.295
2025-11-19 09:30:30,645 | film_recommender_cg.trainer | INFO | 'Thriller' rmse = 0.827
2025-11-19 09:30:30,649 | film_recommender_cg.trainer | INFO | 'Thriller' r-squared = 0.316
2025-11-19 09:30:30,663 | film_recommender_cg.trainer | INFO | 'Undisclosed' rmse = Insufficient Data
2025-11-19 09:30:30,671 | film_recommender_cg.trainer | INFO | 'Undisclosed' r-squared = Insufficient Data
2025-11-19 09:30:30,690 | film_recommender_cg.trainer | INFO | 'Fantasy' rmse = 0.867
2025-11-19 09:30:30,694 | film_recommender_cg.trainer | INFO | 'Fantasy' r-squared = 0.312
2025-11-19 09:30:30,716 | film_recommender_cg.trainer | INFO | 'Family' rmse = 0.869
2025-11-19 09:30:30,719 | film_recommender_cg.trainer | INFO | 'Family' r-squared = 0.3
2025-11-19 09:30:32,118 | film_recommender_cg.trainer | INFO | 'training_performance_metrics' successfully logged as artifact in W&B.
2025-11-19 09:30:32,120 | film_recommender_cg.trainer | INFO | Evaluation of SVD model complete!
2025-11-19 09:30:32,125 | film_recommender_cg.trainer | INFO | Evaluating model performance on recent data...
2025-11-19 09:30:32,306 | film_recommender_cg.trainer | INFO | ### Model Performance Metrics (Overall): ###
2025-11-19 09:30:32,317 | film_recommender_cg.trainer | INFO | RMSE: 0.64
2025-11-19 09:30:32,320 | film_recommender_cg.trainer | INFO | squared: -0.034
2025-11-19 09:30:32,388 | film_recommender_cg.trainer | INFO | Loading in 'genres' table...
2025-11-19 09:30:32,694 | film_recommender_cg.db_connector | INFO | Successfully read collection 'genres'. Shape of df: (4877, 2)
2025-11-19 09:30:33,003 | film_recommender_cg.trainer | INFO | Table successfully loaded!
2025-11-19 09:30:33,026 | film_recommender_cg.trainer | INFO | ### Model Performance Metrics (by Genre): ###
2025-11-19 09:30:33,043 | film_recommender_cg.trainer | INFO | 'Action' rmse = 0.84
2025-11-19 09:30:33,046 | film_recommender_cg.trainer | INFO | 'Action' r-squared = -0.81
2025-11-19 09:30:33,051 | film_recommender_cg.trainer | INFO | 'Horror' rmse = Insufficient Data
2025-11-19 09:30:33,053 | film_recommender_cg.trainer | INFO | 'Horror' r-squared = Insufficient Data
2025-11-19 09:30:33,065 | film_recommender_cg.trainer | INFO | 'Documentary' rmse = 0.573
2025-11-19 09:30:33,068 | film_recommender_cg.trainer | INFO | 'Documentary' r-squared = 0.116
2025-11-19 09:30:33,079 | film_recommender_cg.trainer | INFO | 'Comedy' rmse = 0.618
2025-11-19 09:30:33,083 | film_recommender_cg.trainer | INFO | 'Comedy' r-squared = 0.008
2025-11-19 09:30:33,098 | film_recommender_cg.trainer | INFO | 'Crime' rmse = 0.702
2025-11-19 09:30:33,101 | film_recommender_cg.trainer | INFO | 'Crime' r-squared = -0.211
2025-11-19 09:30:33,116 | film_recommender_cg.trainer | INFO | 'Science Fiction' rmse = 0.632
2025-11-19 09:30:33,118 | film_recommender_cg.trainer | INFO | 'Science Fiction' r-squared = -0.122
2025-11-19 09:30:33,123 | film_recommender_cg.trainer | INFO | 'History' rmse = 0.668
2025-11-19 09:30:33,125 | film_recommender_cg.trainer | INFO | 'History' r-squared = -0.193
2025-11-19 09:30:33,133 | film_recommender_cg.trainer | INFO | 'Mystery' rmse = 0.632
2025-11-19 09:30:33,146 | film_recommender_cg.trainer | INFO | 'Mystery' r-squared = -0.104
2025-11-19 09:30:33,153 | film_recommender_cg.trainer | INFO | 'Drama' rmse = 0.645
2025-11-19 09:30:33,164 | film_recommender_cg.trainer | INFO | 'Drama' r-squared = -0.048
2025-11-19 09:30:33,169 | film_recommender_cg.trainer | INFO | 'Music' rmse = Insufficient Data
2025-11-19 09:30:33,182 | film_recommender_cg.trainer | INFO | 'Music' r-squared = Insufficient Data
2025-11-19 09:30:33,189 | film_recommender_cg.trainer | INFO | 'Western' rmse = 0.666
2025-11-19 09:30:33,194 | film_recommender_cg.trainer | INFO | 'Western' r-squared = -0.096
2025-11-19 09:30:33,199 | film_recommender_cg.trainer | INFO | 'Animation' rmse = Insufficient Data
2025-11-19 09:30:33,201 | film_recommender_cg.trainer | INFO | 'Animation' r-squared = Insufficient Data
2025-11-19 09:30:33,208 | film_recommender_cg.trainer | INFO | 'TV Movie' rmse = Insufficient Data
2025-11-19 09:30:33,212 | film_recommender_cg.trainer | INFO | 'TV Movie' r-squared = Insufficient Data
2025-11-19 09:30:33,217 | film_recommender_cg.trainer | INFO | 'Foreign' rmse = Insufficient Data
2025-11-19 09:30:33,220 | film_recommender_cg.trainer | INFO | 'Foreign' r-squared = Insufficient Data
2025-11-19 09:30:33,233 | film_recommender_cg.trainer | INFO | 'Romance' rmse = 0.605
2025-11-19 09:30:33,243 | film_recommender_cg.trainer | INFO | 'Romance' r-squared = 0.091
2025-11-19 09:30:33,250 | film_recommender_cg.trainer | INFO | 'Adventure' rmse = 0.72
2025-11-19 09:30:33,261 | film_recommender_cg.trainer | INFO | 'Adventure' r-squared = -0.311
2025-11-19 09:30:33,280 | film_recommender_cg.trainer | INFO | 'War' rmse = 0.641
2025-11-19 09:30:33,283 | film_recommender_cg.trainer | INFO | 'War' r-squared = -0.061
2025-11-19 09:30:33,290 | film_recommender_cg.trainer | INFO | 'Thriller' rmse = 0.701
2025-11-19 09:30:33,293 | film_recommender_cg.trainer | INFO | 'Thriller' r-squared = -0.194
2025-11-19 09:30:33,300 | film_recommender_cg.trainer | INFO | 'Undisclosed' rmse = Insufficient Data
2025-11-19 09:30:33,310 | film_recommender_cg.trainer | INFO | 'Undisclosed' r-squared = Insufficient Data
2025-11-19 09:30:33,316 | film_recommender_cg.trainer | INFO | 'Fantasy' rmse = 0.59
2025-11-19 09:30:33,318 | film_recommender_cg.trainer | INFO | 'Fantasy' r-squared = -0.295
2025-11-19 09:30:33,325 | film_recommender_cg.trainer | INFO | 'Family' rmse = 0.618
2025-11-19 09:30:33,327 | film_recommender_cg.trainer | INFO | 'Family' r-squared = -0.291
2025-11-19 09:30:33,341 | film_recommender_cg.trainer | INFO | Evaluation complete!
2025-11-19 09:30:33,344 | film_recommender_cg.trainer | INFO | Evaluating model performance on recent data...
2025-11-19 09:30:33,513 | film_recommender_cg.trainer | INFO | ### Model Performance Metrics (Overall): ###
2025-11-19 09:30:33,519 | film_recommender_cg.trainer | INFO | RMSE: 0.555
2025-11-19 09:30:33,522 | film_recommender_cg.trainer | INFO | squared: 0.221
2025-11-19 09:30:33,572 | film_recommender_cg.trainer | INFO | Loading in 'genres' table...
2025-11-19 09:30:33,753 | film_recommender_cg.db_connector | INFO | Successfully read collection 'genres'. Shape of df: (4877, 2)
2025-11-19 09:30:33,859 | film_recommender_cg.trainer | INFO | Table successfully loaded!
2025-11-19 09:30:33,867 | film_recommender_cg.trainer | INFO | ### Model Performance Metrics (by Genre): ###
2025-11-19 09:30:33,874 | film_recommender_cg.trainer | INFO | 'Action' rmse = 0.622
2025-11-19 09:30:33,877 | film_recommender_cg.trainer | INFO | 'Action' r-squared = 0.009
2025-11-19 09:30:33,882 | film_recommender_cg.trainer | INFO | 'Horror' rmse = Insufficient Data
2025-11-19 09:30:33,884 | film_recommender_cg.trainer | INFO | 'Horror' r-squared = Insufficient Data
2025-11-19 09:30:33,892 | film_recommender_cg.trainer | INFO | 'Documentary' rmse = 0.552
2025-11-19 09:30:33,894 | film_recommender_cg.trainer | INFO | 'Documentary' r-squared = 0.18
2025-11-19 09:30:33,902 | film_recommender_cg.trainer | INFO | 'Comedy' rmse = 0.558
2025-11-19 09:30:33,905 | film_recommender_cg.trainer | INFO | 'Comedy' r-squared = 0.192
2025-11-19 09:30:33,912 | film_recommender_cg.trainer | INFO | 'Crime' rmse = 0.549
2025-11-19 09:30:33,915 | film_recommender_cg.trainer | INFO | 'Crime' r-squared = 0.26
2025-11-19 09:30:33,924 | film_recommender_cg.trainer | INFO | 'Science Fiction' rmse = 0.583
2025-11-19 09:30:33,927 | film_recommender_cg.trainer | INFO | 'Science Fiction' r-squared = 0.044
2025-11-19 09:30:33,937 | film_recommender_cg.trainer | INFO | 'History' rmse = 0.555
2025-11-19 09:30:33,941 | film_recommender_cg.trainer | INFO | 'History' r-squared = 0.178
2025-11-19 09:30:33,947 | film_recommender_cg.trainer | INFO | 'Mystery' rmse = 0.518
2025-11-19 09:30:33,949 | film_recommender_cg.trainer | INFO | 'Mystery' r-squared = 0.26
2025-11-19 09:30:33,960 | film_recommender_cg.trainer | INFO | 'Drama' rmse = 0.548
2025-11-19 09:30:33,964 | film_recommender_cg.trainer | INFO | 'Drama' r-squared = 0.242
2025-11-19 09:30:33,971 | film_recommender_cg.trainer | INFO | 'Music' rmse = Insufficient Data
2025-11-19 09:30:33,977 | film_recommender_cg.trainer | INFO | 'Music' r-squared = Insufficient Data
2025-11-19 09:30:33,986 | film_recommender_cg.trainer | INFO | 'Western' rmse = 0.607
2025-11-19 09:30:33,989 | film_recommender_cg.trainer | INFO | 'Western' r-squared = 0.09
2025-11-19 09:30:33,994 | film_recommender_cg.trainer | INFO | 'Animation' rmse = Insufficient Data
2025-11-19 09:30:33,997 | film_recommender_cg.trainer | INFO | 'Animation' r-squared = Insufficient Data
2025-11-19 09:30:34,002 | film_recommender_cg.trainer | INFO | 'TV Movie' rmse = Insufficient Data
2025-11-19 09:30:34,005 | film_recommender_cg.trainer | INFO | 'TV Movie' r-squared = Insufficient Data
2025-11-19 09:30:34,011 | film_recommender_cg.trainer | INFO | 'Foreign' rmse = Insufficient Data
2025-11-19 09:30:34,013 | film_recommender_cg.trainer | INFO | 'Foreign' r-squared = Insufficient Data
2025-11-19 09:30:34,026 | film_recommender_cg.trainer | INFO | 'Romance' rmse = 0.556
2025-11-19 09:30:34,029 | film_recommender_cg.trainer | INFO | 'Romance' r-squared = 0.233
2025-11-19 09:30:34,037 | film_recommender_cg.trainer | INFO | 'Adventure' rmse = 0.596
2025-11-19 09:30:34,040 | film_recommender_cg.trainer | INFO | 'Adventure' r-squared = 0.103
2025-11-19 09:30:34,053 | film_recommender_cg.trainer | INFO | 'War' rmse = 0.553
2025-11-19 09:30:34,057 | film_recommender_cg.trainer | INFO | 'War' r-squared = 0.211
2025-11-19 09:30:34,064 | film_recommender_cg.trainer | INFO | 'Thriller' rmse = 0.554
2025-11-19 09:30:34,067 | film_recommender_cg.trainer | INFO | 'Thriller' r-squared = 0.253
2025-11-19 09:30:34,072 | film_recommender_cg.trainer | INFO | 'Undisclosed' rmse = Insufficient Data
2025-11-19 09:30:34,075 | film_recommender_cg.trainer | INFO | 'Undisclosed' r-squared = Insufficient Data
2025-11-19 09:30:34,084 | film_recommender_cg.trainer | INFO | 'Fantasy' rmse = 0.511
2025-11-19 09:30:34,087 | film_recommender_cg.trainer | INFO | 'Fantasy' r-squared = 0.028
2025-11-19 09:30:34,095 | film_recommender_cg.trainer | INFO | 'Family' rmse = 0.548
2025-11-19 09:30:34,097 | film_recommender_cg.trainer | INFO | 'Family' r-squared = -0.014
2025-11-19 09:30:34,100 | film_recommender_cg.trainer | INFO | Evaluation complete!
2025-11-19 09:30:34,104 | film_recommender_cg.trainer | INFO | 'Horror' segment below sample size threshold for performance evaluation, therefore will not be considered for comparison (as not considered a 'Critical' metric).
2025-11-19 09:30:34,108 | film_recommender_cg.trainer | INFO | 'Music' segment below sample size threshold for performance evaluation, therefore will not be considered for comparison (as not considered a 'Critical' metric).
2025-11-19 09:30:34,110 | film_recommender_cg.trainer | INFO | 'Animation' segment below sample size threshold for performance evaluation, therefore will not be considered for comparison (as not considered a 'Critical' metric).
2025-11-19 09:30:34,113 | film_recommender_cg.trainer | INFO | Logging SVD model in W&B...
2025-11-19 09:30:35,316 | film_recommender_cg.trainer | INFO | SVD model successfully logged!
2025-11-19 09:30:35,328 | film_recommender_cg.trainer | INFO |
                    Retraining was triggered because the performance of ['Action', 'Crime', 'Adventure'] had degraded since the last training.
                    The challenger model improved one or more degraded metrics while keeping the remaining metrics within the allowed tolerance.
                    The challenger has therefore been promoted to production as the new champion model!

