2025-11-14 09:46:18,356 | film_recommender_cg.scorer | INFO | 'Scorer' object instantiated; W&B run initialized.
2025-11-14 09:46:18,360 | film_recommender_cg.scorer | INFO | Loading in 'ratings' data...
2025-11-14 09:46:24,325 | film_recommender_cg.db_connector | INFO | Successfully read collection 'ratings'. Shape of df: (174555, 4)
2025-11-14 09:46:24,363 | film_recommender_cg.scorer | INFO | Data successfully loaded!
2025-11-14 09:46:24,366 | film_recommender_cg.scorer | INFO | Number of 'existing' users: 1794 -> Using SVD collaborative filtering model to generate these recommendations...
2025-11-14 09:46:24,368 | film_recommender_cg.scorer | INFO | Number of 'New' users: 14 -> Falling back to cold-start strategy of recommending top 'n' films by popularity...
2025-11-14 09:46:24,370 | film_recommender_cg.scorer | INFO | Ratings data loaded successfully.
2025-11-14 09:46:24,561 | film_recommender_cg.db_connector | INFO | Successfully read collection 'genres'. Shape of df: (4877, 2)
2025-11-14 09:46:24,819 | film_recommender_cg.scorer | INFO | Genres table loaded successfully.
2025-11-14 09:46:24,821 | film_recommender_cg.scorer | INFO | Loading in model from W&B...
[34m[1mwandb[0m:   1 of 1 files downloaded.
2025-11-14 09:46:26,365 | film_recommender_cg.scorer | INFO | Model successfully loaded!
2025-11-14 09:46:26,369 | film_recommender_cg.scorer | INFO | Model imported successfully.
2025-11-14 09:46:26,371 | film_recommender_cg.scorer | INFO | Scoring for 'existing' users...
2025-11-14 09:47:52,054 | film_recommender_cg.scorer | ERROR | Failed to generate rankings for existing users.
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/film_recommender_cg/scorer.py", line 136, in score_simulate_and_update_ratings_table
    rankings_generated_existing_users = self._get_ranked_films_per_user_existing(
  File "/usr/local/lib/python3.10/site-packages/film_recommender_cg/scorer.py", line 829, in _get_ranked_films_per_user_existing
    interaction_matrix = self._reconstruct_interaction_matrix_and_predict_ratings(ratings_existing, existing_users, model)
  File "/usr/local/lib/python3.10/site-packages/film_recommender_cg/scorer.py", line 733, in _reconstruct_interaction_matrix_and_predict_ratings
    interaction_matrix = full_matrix_df.pivot(index='user_id', columns='film_id', values='predicted_rating')
  File "/usr/local/lib/python3.10/site-packages/pandas/core/frame.py", line 9366, in pivot
    return pivot(self, index=index, columns=columns, values=values)
  File "/usr/local/lib/python3.10/site-packages/pandas/core/reshape/pivot.py", line 570, in pivot
    result = indexed.unstack(columns_listlike)  # type: ignore[arg-type]
  File "/usr/local/lib/python3.10/site-packages/pandas/core/series.py", line 4634, in unstack
    return unstack(self, level, fill_value, sort)
  File "/usr/local/lib/python3.10/site-packages/pandas/core/reshape/reshape.py", line 517, in unstack
    unstacker = _Unstacker(
  File "/usr/local/lib/python3.10/site-packages/pandas/core/reshape/reshape.py", line 154, in __init__
    self._make_selectors()
  File "/usr/local/lib/python3.10/site-packages/pandas/core/reshape/reshape.py", line 210, in _make_selectors
    raise ValueError("Index contains duplicate entries, cannot reshape")
ValueError: Index contains duplicate entries, cannot reshape
2025-11-14 09:47:52,079 | film_recommender_cg.scorer | ERROR | Error occurred in running 'score_simulate_and_update_ratings_table()'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/film_recommender_cg/scorer.py", line 136, in score_simulate_and_update_ratings_table
    rankings_generated_existing_users = self._get_ranked_films_per_user_existing(
  File "/usr/local/lib/python3.10/site-packages/film_recommender_cg/scorer.py", line 829, in _get_ranked_films_per_user_existing
    interaction_matrix = self._reconstruct_interaction_matrix_and_predict_ratings(ratings_existing, existing_users, model)
  File "/usr/local/lib/python3.10/site-packages/film_recommender_cg/scorer.py", line 733, in _reconstruct_interaction_matrix_and_predict_ratings
    interaction_matrix = full_matrix_df.pivot(index='user_id', columns='film_id', values='predicted_rating')
  File "/usr/local/lib/python3.10/site-packages/pandas/core/frame.py", line 9366, in pivot
    return pivot(self, index=index, columns=columns, values=values)
  File "/usr/local/lib/python3.10/site-packages/pandas/core/reshape/pivot.py", line 570, in pivot
    result = indexed.unstack(columns_listlike)  # type: ignore[arg-type]
  File "/usr/local/lib/python3.10/site-packages/pandas/core/series.py", line 4634, in unstack
    return unstack(self, level, fill_value, sort)
  File "/usr/local/lib/python3.10/site-packages/pandas/core/reshape/reshape.py", line 517, in unstack
    unstacker = _Unstacker(
  File "/usr/local/lib/python3.10/site-packages/pandas/core/reshape/reshape.py", line 154, in __init__
    self._make_selectors()
  File "/usr/local/lib/python3.10/site-packages/pandas/core/reshape/reshape.py", line 210, in _make_selectors
    raise ValueError("Index contains duplicate entries, cannot reshape")
ValueError: Index contains duplicate entries, cannot reshape
