2025-11-04 10:30:40,007 | scorer | INFO | 'Scorer' object instantiated; W&B run initialized.
2025-11-04 10:30:40,009 | scorer | INFO | Loading in 'ratings' data...
2025-11-04 10:30:43,867 | db_connector | INFO | Successfully read collection 'ratings'. Shape of df: (120000, 4)
2025-11-04 10:30:43,904 | scorer | INFO | Data successfully loaded!
2025-11-04 10:30:43,907 | scorer | INFO | Number of 'Old' users: 1584 -> Using SVD collaborative filtering model to generate these recommendations...
2025-11-04 10:30:43,911 | scorer | INFO | Number of 'New' users: 224 -> Falling back to cold-start strategy of recommending top 'n' films by popularity...
2025-11-04 10:30:43,914 | scorer | INFO | Ratings data loaded successfully.
2025-11-04 10:30:44,063 | db_connector | INFO | Successfully read collection 'genres'. Shape of df: (4877, 2)
2025-11-04 10:30:44,175 | scorer | INFO | Genres table loaded successfully.
2025-11-04 10:30:44,177 | scorer | INFO | Loading in model from W&B...
[34m[1mwandb[0m:   1 of 1 files downloaded.
2025-11-04 10:30:45,445 | scorer | INFO | Model successfully loaded!
2025-11-04 10:30:45,447 | scorer | INFO | Model imported successfully.
2025-11-04 10:30:45,449 | scorer | INFO | Scoring for 'old' users...
DEBUG 1!!!!!!!!!!!
DEBUG 2!!!!!!!!!!!
DEBUG 3!!!!!!!!!!!
DEBUG 4!!!!!!!!!!!
DEBUG 5!!!!!!!!!!!
DEBUG 6!!!!!!!!!!!
2025-11-04 10:32:01,696 | scorer | INFO | Scoring complete for 'old' users!
2025-11-04 10:32:01,792 | scorer | INFO | Rankings for old users generated successfully.
2025-11-04 10:32:01,795 | scorer | INFO | Scoring for 'new' users...
2025-11-04 10:32:01,867 | scorer | INFO | Scoring complete for 'new' users!
2025-11-04 10:32:01,871 | scorer | INFO | Rankings for new users generated successfully.
2025-11-04 10:32:01,874 | scorer | INFO | Simulating interactions for 'old' users...
2025-11-04 10:32:08,457 | scorer | ERROR | Failed to simulate film choices for old users.
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 939, in _finalize_columns_and_data
    columns = _validate_or_indexify_columns(contents, columns)
  File "/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 986, in _validate_or_indexify_columns
    raise AssertionError(
AssertionError: 6 columns passed, passed data had 5 columns

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/Streaming_Service_Recommendation_Simulation/film_recommender/scorer.py", line 109, in score_simulate_and_update_ratings_table
    new_interactions_old_users = self._simulate_batch_of_film_choices(old_users, rankings_generated_old_users, ratings,genres_table, genre_to_penalize, genre_penalty, 'old')
  File "/app/Streaming_Service_Recommendation_Simulation/film_recommender/scorer.py", line 618, in _simulate_batch_of_film_choices
    interactions_df = pd.DataFrame(interactions, columns=list(ratings.columns) + ['predicted_rating', 'genres'])
  File "/usr/local/lib/python3.10/site-packages/pandas/core/frame.py", line 855, in __init__
    arrays, columns, index = nested_data_to_arrays(
  File "/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 520, in nested_data_to_arrays
    arrays, columns = to_arrays(data, columns, dtype=dtype)
  File "/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 845, in to_arrays
    content, columns = _finalize_columns_and_data(arr, columns, dtype)
  File "/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 942, in _finalize_columns_and_data
    raise ValueError(err) from err
ValueError: 6 columns passed, passed data had 5 columns
2025-11-04 10:32:08,473 | scorer | ERROR | Error occurred in running 'score_simulate_and_update_ratings_table()'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 939, in _finalize_columns_and_data
    columns = _validate_or_indexify_columns(contents, columns)
  File "/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 986, in _validate_or_indexify_columns
    raise AssertionError(
AssertionError: 6 columns passed, passed data had 5 columns

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/Streaming_Service_Recommendation_Simulation/film_recommender/scorer.py", line 109, in score_simulate_and_update_ratings_table
    new_interactions_old_users = self._simulate_batch_of_film_choices(old_users, rankings_generated_old_users, ratings,genres_table, genre_to_penalize, genre_penalty, 'old')
  File "/app/Streaming_Service_Recommendation_Simulation/film_recommender/scorer.py", line 618, in _simulate_batch_of_film_choices
    interactions_df = pd.DataFrame(interactions, columns=list(ratings.columns) + ['predicted_rating', 'genres'])
  File "/usr/local/lib/python3.10/site-packages/pandas/core/frame.py", line 855, in __init__
    arrays, columns, index = nested_data_to_arrays(
  File "/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 520, in nested_data_to_arrays
    arrays, columns = to_arrays(data, columns, dtype=dtype)
  File "/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 845, in to_arrays
    content, columns = _finalize_columns_and_data(arr, columns, dtype)
  File "/usr/local/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 942, in _finalize_columns_and_data
    raise ValueError(err) from err
ValueError: 6 columns passed, passed data had 5 columns
